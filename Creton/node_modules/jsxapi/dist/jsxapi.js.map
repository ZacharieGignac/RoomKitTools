{"version":3,"sources":["../node_modules/events/events.js","../node_modules/loglevel/lib/loglevel.js","log.ts","backend/ws.ts","../node_modules/requires-port/index.js","../node_modules/querystringify/index.js","../node_modules/url-parse/index.js","connect.ts","../node_modules/base64-js/index.js","../node_modules/ieee754/index.js","../node_modules/isarray/index.js","../node_modules/buffer/index.js","transport/ws.ts","xapi/normalizePath.ts","xapi/exc.ts","xapi/rpc.ts","version.ts","xapi/mixins.ts","xapi/components.ts","xapi/feedback.ts","xapi/proxy.ts","xapi/index.ts","browser.ts"],"names":["R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ReflectOwnKeys","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","ProcessEmitWarning","warning","console","warn","NumberIsNaN","Number","isNaN","value","EventEmitter","init","module","exports","once","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","defineProperty","enumerable","get","set","arg","RangeError","getPrototypeOf","create","setMaxListeners","n","_getMaxListeners","that","getMaxListeners","emit","type","i","arguments","length","push","doError","events","error","er","Error","err","message","context","handler","len","listeners","arrayClone","_addListener","prepend","m","existing","newListener","unshift","warned","w","String","name","emitter","count","addListener","on","prependListener","onceWrapper","fired","removeListener","wrapFn","_onceWrap","state","wrapped","bind","prependOnceListener","list","position","originalListener","shift","spliceOne","off","removeAllListeners","keys","key","_listeners","unwrap","evlistener","unwrapListeners","rawListeners","listenerCount","eventNames","arr","copy","Array","index","pop","ret","Promise","resolve","reject","errorListener","resolver","slice","eventTargetAgnosticAddListener","addErrorHandlerIfEventEmitter","flags","addEventListener","wrapListener","removeEventListener","root","definition","define","amd","log","noop","undefinedType","isIE","window","navigator","test","userAgent","logMethods","bindMethod","obj","methodName","method","e","traceForIE","trace","realMethod","replaceLoggingMethods","level","loggerName","methodFactory","debug","enableLoggingWhenConsoleArrives","defaultMethodFactory","Logger","defaultLevel","factory","self","currentLevel","storageKey","persistLevelIfPossible","levelNum","levelName","toUpperCase","localStorage","ignore","document","cookie","encodeURIComponent","getPersistedLevel","storedLevel","location","indexOf","exec","levels","getLevel","setLevel","persist","SILENT","setDefaultLevel","enableAll","TRACE","disableAll","initialLevel","defaultLogger","_loggersByName","getLogger","logger","_log","noConflict","getLoggers"],"mappings":"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IAAI,CAAC,SAAL,CAAe,OAAf,CAAlC;;AACA,MAAA,KAAI,CAAC,EAAL,CAAQ,IAAR,CAAa,IAAI,CAAC,SAAL,CAAe,OAAf,CAAb;AACD,KAHM,CAAP;AAID,GALM;;AAwBT,SAAA,SAAA;AA1DA,CAAA,CAAuC,QAAA,CAAA,YAAvC,CAAA;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"jsxapi.js","sourceRoot":"../src","sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","/*\n * This module basically patches the `loglevel` library with some niceities for\n * named loggers. Named loggers prefix the log output with their log name and\n * their level can be set independently.\n */\n\nimport loglevel from 'loglevel';\n\nif (!(loglevel as any).isPatched) {\n  const origMethodFactory = loglevel.methodFactory;\n  const loggers = new Set<string>();\n\n  /*\n   * Bless the `log` object with custom plugins\n   */\n  Object.assign(loglevel, {\n    isPatched: true,\n\n    methodFactory(methodName: string, logLevel: any, loggerName: string) {\n      if (loggerName) {\n        loggers.add(loggerName);\n      }\n      const rawMethod = origMethodFactory(methodName, logLevel, loggerName);\n      return (...args: any[]) => {\n        rawMethod(`[${loggerName || 'root'}]`, ...args);\n      };\n    },\n\n    /*\n     * Returns a list of logger names, excluding the root logger.\n     */\n    getLoggers() {\n      return Array.from(loggers);\n    },\n\n    setGlobalLevel(level: loglevel.LogLevelDesc) {\n      const allLoggers = [loglevel].concat(\n        (loglevel as any)\n          .getLoggers()\n          .map((name: string) => loglevel.getLogger(name)),\n      );\n\n      allLoggers.forEach((logger) => {\n        logger.setLevel(level);\n      });\n    },\n\n    setLevelTrace() {\n      (loglevel as any).setGlobalLevel('trace');\n    },\n    setLevelDebug() {\n      (loglevel as any).setGlobalLevel('debug');\n    },\n    setLevelInfo() {\n      (loglevel as any).setGlobalLevel('info');\n    },\n    setLevelWarn() {\n      (loglevel as any).setGlobalLevel('warn');\n    },\n    setLevelError() {\n      (loglevel as any).setGlobalLevel('error');\n    },\n  });\n\n  // Required to apply the plugin to log\n  loglevel.setLevel(loglevel.getLevel());\n}\n\nexport default loglevel.getLogger('jsxapi');\n","import { EventEmitter } from 'events';\nimport WS from 'ws';\n\nimport log from '../log';\nimport { XapiRequest } from '../xapi/types';\nimport { Backend } from './';\n\n/**\n * @external {WebSocket} https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n */\n\n/**\n * Backend to communicate with a WebSocket server.\n *\n * This backend expects to talk directly to a JSON-RPC WebSocket backend.\n * Authentication has to be handled by the transport layer, there is no\n * support for that on the socket itself.\n *\n * Once the socket is open, it is expected to be in the ready state.\n *\n * @implements {Backend}\n */\nexport default class WSBackend extends EventEmitter implements Backend {\n  private ws: WS | WebSocket;\n  private isReady: Promise<boolean>;\n\n  /**\n   * @param {Object|string} urlOrWS - WebSocket object or URL of the server.\n   */\n  constructor(urlOrWS: WS | WebSocket | string) {\n    super();\n    /**\n     * @type {WebSocket}\n     */\n    this.ws = typeof urlOrWS !== 'string' ? urlOrWS : new WebSocket(urlOrWS);\n    this.ws.onclose = this.handleClose;\n    this.ws.onerror = this.handleError;\n    this.ws.onmessage = this.handleMessage;\n\n    let resolveReady: (ready: boolean) => void;\n    /**\n     * @type {Promise}\n     */\n    this.isReady = new Promise((r) => {\n      resolveReady = r;\n    });\n    this.ws.onopen = () => {\n      this.emit('ready');\n      resolveReady(true);\n    };\n  }\n\n  public close() {\n    this.ws.close();\n  }\n\n  public execute(command: XapiRequest): Promise<void> {\n    return this.isReady.then(() => {\n      log.debug('[transport] (send): ', JSON.stringify(command));\n      this.ws.send(JSON.stringify(command));\n    });\n  }\n\n  private handleClose: WebSocket['onclose'] = (event) => {\n    if (event.code !== 1000) {\n      this.emit('error', 'WebSocket closed unexpectedly');\n    } else {\n      this.emit('close');\n    }\n  }\n\n  private handleError: WebSocket['onerror'] = (error) => {\n    this.emit('error', (error as ErrorEvent).error);\n  }\n\n  private handleMessage: WebSocket['onmessage'] = (message) => {\n    log.debug('[transport] (receive): ', message.data);\n    const data = JSON.parse(message.data as string);\n    this.emit('data', data);\n  }\n}\n","'use strict';\n\n/**\n * Check if we're required to add a port number.\n *\n * @see https://url.spec.whatwg.org/#default-port\n * @param {Number|String} port Port number we need to check\n * @param {String} protocol Protocol we need to check against.\n * @returns {Boolean} Is it a default port for the given protocol\n * @api private\n */\nmodule.exports = function required(port, protocol) {\n  protocol = protocol.split(':')[0];\n  port = +port;\n\n  if (!port) return false;\n\n  switch (protocol) {\n    case 'http':\n    case 'ws':\n    return port !== 80;\n\n    case 'https':\n    case 'wss':\n    return port !== 443;\n\n    case 'ftp':\n    return port !== 21;\n\n    case 'gopher':\n    return port !== 70;\n\n    case 'file':\n    return false;\n  }\n\n  return port !== 0;\n};\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , undef;\n\n/**\n * Decode a URI encoded string.\n *\n * @param {String} input The URI encoded string.\n * @returns {String|Null} The decoded string.\n * @api private\n */\nfunction decode(input) {\n  try {\n    return decodeURIComponent(input.replace(/\\+/g, ' '));\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Attempts to encode a given input.\n *\n * @param {String} input The string that needs to be encoded.\n * @returns {String|Null} The encoded string.\n * @api private\n */\nfunction encode(input) {\n  try {\n    return encodeURIComponent(input);\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Simple query string parser.\n *\n * @param {String} query The query string that needs to be parsed.\n * @returns {Object}\n * @api public\n */\nfunction querystring(query) {\n  var parser = /([^=?#&]+)=?([^&]*)/g\n    , result = {}\n    , part;\n\n  while (part = parser.exec(query)) {\n    var key = decode(part[1])\n      , value = decode(part[2]);\n\n    //\n    // Prevent overriding of existing properties. This ensures that build-in\n    // methods like `toString` or __proto__ are not overriden by malicious\n    // querystrings.\n    //\n    // In the case if failed decoding, we want to omit the key/value pairs\n    // from the result.\n    //\n    if (key === null || value === null || key in result) continue;\n    result[key] = value;\n  }\n\n  return result;\n}\n\n/**\n * Transform a query string to an object.\n *\n * @param {Object} obj Object that should be transformed.\n * @param {String} prefix Optional prefix.\n * @returns {String}\n * @api public\n */\nfunction querystringify(obj, prefix) {\n  prefix = prefix || '';\n\n  var pairs = []\n    , value\n    , key;\n\n  //\n  // Optionally prefix with a '?' if needed\n  //\n  if ('string' !== typeof prefix) prefix = '?';\n\n  for (key in obj) {\n    if (has.call(obj, key)) {\n      value = obj[key];\n\n      //\n      // Edge cases where we actually want to encode the value to an empty\n      // string instead of the stringified value.\n      //\n      if (!value && (value === null || value === undef || isNaN(value))) {\n        value = '';\n      }\n\n      key = encode(key);\n      value = encode(value);\n\n      //\n      // If we failed to encode the strings, we should bail out as we don't\n      // want to add invalid strings to the query.\n      //\n      if (key === null || value === null) continue;\n      pairs.push(key +'='+ value);\n    }\n  }\n\n  return pairs.length ? prefix + pairs.join('&') : '';\n}\n\n//\n// Expose the module.\n//\nexports.stringify = querystringify;\nexports.parse = querystring;\n","'use strict';\n\nvar required = require('requires-port')\n  , qs = require('querystringify')\n  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//\n  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\\\/]+)?([\\S\\s]*)/i\n  , windowsDriveLetter = /^[a-zA-Z]:/\n  , whitespace = '[\\\\x09\\\\x0A\\\\x0B\\\\x0C\\\\x0D\\\\x20\\\\xA0\\\\u1680\\\\u180E\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200A\\\\u202F\\\\u205F\\\\u3000\\\\u2028\\\\u2029\\\\uFEFF]'\n  , left = new RegExp('^'+ whitespace +'+');\n\n/**\n * Trim a given string.\n *\n * @param {String} str String to trim.\n * @public\n */\nfunction trimLeft(str) {\n  return (str ? str : '').toString().replace(left, '');\n}\n\n/**\n * These are the parse rules for the URL parser, it informs the parser\n * about:\n *\n * 0. The char it Needs to parse, if it's a string it should be done using\n *    indexOf, RegExp using exec and NaN means set as current value.\n * 1. The property we should set when parsing this value.\n * 2. Indication if it's backwards or forward parsing, when set as number it's\n *    the value of extra chars that should be split off.\n * 3. Inherit from location if non existing in the parser.\n * 4. `toLowerCase` the resulting value.\n */\nvar rules = [\n  ['#', 'hash'],                        // Extract from the back.\n  ['?', 'query'],                       // Extract from the back.\n  function sanitize(address, url) {     // Sanitize what is left of the address\n    return isSpecial(url.protocol) ? address.replace(/\\\\/g, '/') : address;\n  },\n  ['/', 'pathname'],                    // Extract from the back.\n  ['@', 'auth', 1],                     // Extract from the front.\n  [NaN, 'host', undefined, 1, 1],       // Set left over value.\n  [/:(\\d+)$/, 'port', undefined, 1],    // RegExp the back.\n  [NaN, 'hostname', undefined, 1, 1]    // Set left over.\n];\n\n/**\n * These properties should not be copied or inherited from. This is only needed\n * for all non blob URL's as a blob URL does not include a hash, only the\n * origin.\n *\n * @type {Object}\n * @private\n */\nvar ignore = { hash: 1, query: 1 };\n\n/**\n * The location object differs when your code is loaded through a normal page,\n * Worker or through a worker using a blob. And with the blobble begins the\n * trouble as the location object will contain the URL of the blob, not the\n * location of the page where our code is loaded in. The actual origin is\n * encoded in the `pathname` so we can thankfully generate a good \"default\"\n * location from it so we can generate proper relative URL's again.\n *\n * @param {Object|String} loc Optional default location object.\n * @returns {Object} lolcation object.\n * @public\n */\nfunction lolcation(loc) {\n  var globalVar;\n\n  if (typeof window !== 'undefined') globalVar = window;\n  else if (typeof global !== 'undefined') globalVar = global;\n  else if (typeof self !== 'undefined') globalVar = self;\n  else globalVar = {};\n\n  var location = globalVar.location || {};\n  loc = loc || location;\n\n  var finaldestination = {}\n    , type = typeof loc\n    , key;\n\n  if ('blob:' === loc.protocol) {\n    finaldestination = new Url(unescape(loc.pathname), {});\n  } else if ('string' === type) {\n    finaldestination = new Url(loc, {});\n    for (key in ignore) delete finaldestination[key];\n  } else if ('object' === type) {\n    for (key in loc) {\n      if (key in ignore) continue;\n      finaldestination[key] = loc[key];\n    }\n\n    if (finaldestination.slashes === undefined) {\n      finaldestination.slashes = slashes.test(loc.href);\n    }\n  }\n\n  return finaldestination;\n}\n\n/**\n * Check whether a protocol scheme is special.\n *\n * @param {String} The protocol scheme of the URL\n * @return {Boolean} `true` if the protocol scheme is special, else `false`\n * @private\n */\nfunction isSpecial(scheme) {\n  return (\n    scheme === 'file:' ||\n    scheme === 'ftp:' ||\n    scheme === 'http:' ||\n    scheme === 'https:' ||\n    scheme === 'ws:' ||\n    scheme === 'wss:'\n  );\n}\n\n/**\n * @typedef ProtocolExtract\n * @type Object\n * @property {String} protocol Protocol matched in the URL, in lowercase.\n * @property {Boolean} slashes `true` if protocol is followed by \"//\", else `false`.\n * @property {String} rest Rest of the URL that is not part of the protocol.\n */\n\n/**\n * Extract protocol information from a URL with/without double slash (\"//\").\n *\n * @param {String} address URL we want to extract from.\n * @param {Object} location\n * @return {ProtocolExtract} Extracted information.\n * @private\n */\nfunction extractProtocol(address, location) {\n  address = trimLeft(address);\n  location = location || {};\n\n  var match = protocolre.exec(address);\n  var protocol = match[1] ? match[1].toLowerCase() : '';\n  var forwardSlashes = !!match[2];\n  var otherSlashes = !!match[3];\n  var slashesCount = 0;\n  var rest;\n\n  if (forwardSlashes) {\n    if (otherSlashes) {\n      rest = match[2] + match[3] + match[4];\n      slashesCount = match[2].length + match[3].length;\n    } else {\n      rest = match[2] + match[4];\n      slashesCount = match[2].length;\n    }\n  } else {\n    if (otherSlashes) {\n      rest = match[3] + match[4];\n      slashesCount = match[3].length;\n    } else {\n      rest = match[4]\n    }\n  }\n\n  if (protocol === 'file:') {\n    if (slashesCount >= 2) {\n      rest = rest.slice(2);\n    }\n  } else if (isSpecial(protocol)) {\n    rest = match[4];\n  } else if (protocol) {\n    if (forwardSlashes) {\n      rest = rest.slice(2);\n    }\n  } else if (slashesCount >= 2 && isSpecial(location.protocol)) {\n    rest = match[4];\n  }\n\n  return {\n    protocol: protocol,\n    slashes: forwardSlashes || isSpecial(protocol),\n    slashesCount: slashesCount,\n    rest: rest\n  };\n}\n\n/**\n * Resolve a relative URL pathname against a base URL pathname.\n *\n * @param {String} relative Pathname of the relative URL.\n * @param {String} base Pathname of the base URL.\n * @return {String} Resolved pathname.\n * @private\n */\nfunction resolve(relative, base) {\n  if (relative === '') return base;\n\n  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))\n    , i = path.length\n    , last = path[i - 1]\n    , unshift = false\n    , up = 0;\n\n  while (i--) {\n    if (path[i] === '.') {\n      path.splice(i, 1);\n    } else if (path[i] === '..') {\n      path.splice(i, 1);\n      up++;\n    } else if (up) {\n      if (i === 0) unshift = true;\n      path.splice(i, 1);\n      up--;\n    }\n  }\n\n  if (unshift) path.unshift('');\n  if (last === '.' || last === '..') path.push('');\n\n  return path.join('/');\n}\n\n/**\n * The actual URL instance. Instead of returning an object we've opted-in to\n * create an actual constructor as it's much more memory efficient and\n * faster and it pleases my OCD.\n *\n * It is worth noting that we should not use `URL` as class name to prevent\n * clashes with the global URL instance that got introduced in browsers.\n *\n * @constructor\n * @param {String} address URL we want to parse.\n * @param {Object|String} [location] Location defaults for relative paths.\n * @param {Boolean|Function} [parser] Parser for the query string.\n * @private\n */\nfunction Url(address, location, parser) {\n  address = trimLeft(address);\n\n  if (!(this instanceof Url)) {\n    return new Url(address, location, parser);\n  }\n\n  var relative, extracted, parse, instruction, index, key\n    , instructions = rules.slice()\n    , type = typeof location\n    , url = this\n    , i = 0;\n\n  //\n  // The following if statements allows this module two have compatibility with\n  // 2 different API:\n  //\n  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments\n  //    where the boolean indicates that the query string should also be parsed.\n  //\n  // 2. The `URL` interface of the browser which accepts a URL, object as\n  //    arguments. The supplied object will be used as default values / fall-back\n  //    for relative paths.\n  //\n  if ('object' !== type && 'string' !== type) {\n    parser = location;\n    location = null;\n  }\n\n  if (parser && 'function' !== typeof parser) parser = qs.parse;\n\n  location = lolcation(location);\n\n  //\n  // Extract protocol information before running the instructions.\n  //\n  extracted = extractProtocol(address || '', location);\n  relative = !extracted.protocol && !extracted.slashes;\n  url.slashes = extracted.slashes || relative && location.slashes;\n  url.protocol = extracted.protocol || location.protocol || '';\n  address = extracted.rest;\n\n  //\n  // When the authority component is absent the URL starts with a path\n  // component.\n  //\n  if (\n    extracted.protocol === 'file:' && (\n      extracted.slashesCount !== 2 || windowsDriveLetter.test(address)) ||\n    (!extracted.slashes &&\n      (extracted.protocol ||\n        extracted.slashesCount < 2 ||\n        !isSpecial(url.protocol)))\n  ) {\n    instructions[3] = [/(.*)/, 'pathname'];\n  }\n\n  for (; i < instructions.length; i++) {\n    instruction = instructions[i];\n\n    if (typeof instruction === 'function') {\n      address = instruction(address, url);\n      continue;\n    }\n\n    parse = instruction[0];\n    key = instruction[1];\n\n    if (parse !== parse) {\n      url[key] = address;\n    } else if ('string' === typeof parse) {\n      if (~(index = address.indexOf(parse))) {\n        if ('number' === typeof instruction[2]) {\n          url[key] = address.slice(0, index);\n          address = address.slice(index + instruction[2]);\n        } else {\n          url[key] = address.slice(index);\n          address = address.slice(0, index);\n        }\n      }\n    } else if ((index = parse.exec(address))) {\n      url[key] = index[1];\n      address = address.slice(0, index.index);\n    }\n\n    url[key] = url[key] || (\n      relative && instruction[3] ? location[key] || '' : ''\n    );\n\n    //\n    // Hostname, host and protocol should be lowercased so they can be used to\n    // create a proper `origin`.\n    //\n    if (instruction[4]) url[key] = url[key].toLowerCase();\n  }\n\n  //\n  // Also parse the supplied query string in to an object. If we're supplied\n  // with a custom parser as function use that instead of the default build-in\n  // parser.\n  //\n  if (parser) url.query = parser(url.query);\n\n  //\n  // If the URL is relative, resolve the pathname against the base URL.\n  //\n  if (\n      relative\n    && location.slashes\n    && url.pathname.charAt(0) !== '/'\n    && (url.pathname !== '' || location.pathname !== '')\n  ) {\n    url.pathname = resolve(url.pathname, location.pathname);\n  }\n\n  //\n  // Default to a / for pathname if none exists. This normalizes the URL\n  // to always have a /\n  //\n  if (url.pathname.charAt(0) !== '/' && isSpecial(url.protocol)) {\n    url.pathname = '/' + url.pathname;\n  }\n\n  //\n  // We should not add port numbers if they are already the default port number\n  // for a given protocol. As the host also contains the port number we're going\n  // override it with the hostname which contains no port number.\n  //\n  if (!required(url.port, url.protocol)) {\n    url.host = url.hostname;\n    url.port = '';\n  }\n\n  //\n  // Parse down the `auth` for the username and password.\n  //\n  url.username = url.password = '';\n  if (url.auth) {\n    instruction = url.auth.split(':');\n    url.username = instruction[0] || '';\n    url.password = instruction[1] || '';\n  }\n\n  url.origin = url.protocol !== 'file:' && isSpecial(url.protocol) && url.host\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  //\n  // The href is just the compiled result.\n  //\n  url.href = url.toString();\n}\n\n/**\n * This is convenience method for changing properties in the URL instance to\n * insure that they all propagate correctly.\n *\n * @param {String} part          Property we need to adjust.\n * @param {Mixed} value          The newly assigned value.\n * @param {Boolean|Function} fn  When setting the query, it will be the function\n *                               used to parse the query.\n *                               When setting the protocol, double slash will be\n *                               removed from the final url if it is true.\n * @returns {URL} URL instance for chaining.\n * @public\n */\nfunction set(part, value, fn) {\n  var url = this;\n\n  switch (part) {\n    case 'query':\n      if ('string' === typeof value && value.length) {\n        value = (fn || qs.parse)(value);\n      }\n\n      url[part] = value;\n      break;\n\n    case 'port':\n      url[part] = value;\n\n      if (!required(value, url.protocol)) {\n        url.host = url.hostname;\n        url[part] = '';\n      } else if (value) {\n        url.host = url.hostname +':'+ value;\n      }\n\n      break;\n\n    case 'hostname':\n      url[part] = value;\n\n      if (url.port) value += ':'+ url.port;\n      url.host = value;\n      break;\n\n    case 'host':\n      url[part] = value;\n\n      if (/:\\d+$/.test(value)) {\n        value = value.split(':');\n        url.port = value.pop();\n        url.hostname = value.join(':');\n      } else {\n        url.hostname = value;\n        url.port = '';\n      }\n\n      break;\n\n    case 'protocol':\n      url.protocol = value.toLowerCase();\n      url.slashes = !fn;\n      break;\n\n    case 'pathname':\n    case 'hash':\n      if (value) {\n        var char = part === 'pathname' ? '/' : '#';\n        url[part] = value.charAt(0) !== char ? char + value : value;\n      } else {\n        url[part] = value;\n      }\n      break;\n\n    default:\n      url[part] = value;\n  }\n\n  for (var i = 0; i < rules.length; i++) {\n    var ins = rules[i];\n\n    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();\n  }\n\n  url.origin = url.protocol !== 'file:' && isSpecial(url.protocol) && url.host\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  url.href = url.toString();\n\n  return url;\n}\n\n/**\n * Transform the properties back in to a valid and full URL string.\n *\n * @param {Function} stringify Optional query stringify function.\n * @returns {String} Compiled version of the URL.\n * @public\n */\nfunction toString(stringify) {\n  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;\n\n  var query\n    , url = this\n    , protocol = url.protocol;\n\n  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';\n\n  var result = protocol + (url.slashes || isSpecial(url.protocol) ? '//' : '');\n\n  if (url.username) {\n    result += url.username;\n    if (url.password) result += ':'+ url.password;\n    result += '@';\n  }\n\n  result += url.host + url.pathname;\n\n  query = 'object' === typeof url.query ? stringify(url.query) : url.query;\n  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;\n\n  if (url.hash) result += url.hash;\n\n  return result;\n}\n\nUrl.prototype = { set: set, toString: toString };\n\n//\n// Expose the URL parser and some additional properties that might be useful for\n// others or testing.\n//\nUrl.extractProtocol = extractProtocol;\nUrl.location = lolcation;\nUrl.trimLeft = trimLeft;\nUrl.qs = qs;\n\nmodule.exports = Url;\n","import Url from 'url-parse';\n\nimport { Backend } from './backend';\nimport log from './log';\nimport { InitBackend, Options } from './types';\nimport XAPI from './xapi';\n\nexport const globalDefaults: Options = {\n  command: '',\n  host: '',\n  loglevel: 'warn',\n  password: '',\n  port: 0,\n  protocol: '',\n  username: 'admin',\n};\n\nexport interface Connect<T extends XAPI> {\n  (options: Partial<Options>): T;\n  (url: string, options?: Partial<Options>): T;\n}\n\nfunction resolveOptions(\n  targetDefaults: Partial<Options>,\n  url: string,\n  options: Options,\n): Options {\n  const realOpts: Options = {\n    ...globalDefaults,\n    ...targetDefaults,\n  };\n\n  const urlWithProto = url.match(/^\\w+:\\/\\//)\n    ? url\n    : `${realOpts.protocol}//${url}`;\n  const parsedUrl = new Url(urlWithProto);\n\n  Object.keys(realOpts).forEach((key) => {\n    const value = [\n      (options as any)[key],\n      key === 'host' ? parsedUrl.hostname : (parsedUrl as any)[key],\n    ].filter((v) => !!v)[0];\n    if (value) {\n      (realOpts as any)[key] = value;\n    }\n  });\n\n  return realOpts;\n}\n\nexport default function connectOverload<T extends XAPI>(\n  initBackend: InitBackend,\n  defaults: Partial<Options>,\n): (XAPI: new (backend: Backend) => T) => Connect<T> {\n  return (xapi) => (...args: any[]) => {\n    let url: string;\n    let options: Options;\n\n    if (args.length === 1 && typeof args[0] === 'object') {\n      options = args[0];\n      url = '';\n    } else if (args.length === 1 && typeof args[0] === 'string') {\n      options = globalDefaults;\n      url = args[0];\n    } else if (args.length === 2) {\n      url = args[0];\n      options = args[1];\n    } else {\n      throw new Error(`Invalid arguments to connect`);\n    }\n\n    const opts = resolveOptions(defaults, url, options);\n\n    log.setLevel(opts.loglevel);\n    log.debug('using options:', opts);\n    log.info('connecting to', url);\n\n    const backend = initBackend(opts);\n    return new xapi(backend);\n  };\n}\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","import Url from 'url-parse';\n\nimport { Options } from '../types';\n\nexport type CreateWebSocket = (url: string, auth: string) => WebSocket;\n\nfunction base64Enc(input: string) {\n  return (typeof btoa === 'function')\n    ? btoa(input)\n    : Buffer.from(input).toString('base64');\n}\n\nfunction generateAuthSubProto(username: string, password: string): string {\n  const replaceChars: any = { '+': '-', '/': '_', '=': '' };\n  const authHash = Buffer\n    .from(`${username}:${password}`)\n    .toString('base64')\n    .replace(/[/+=]/g, (c) => replaceChars[c]);\n  return `auth-${authHash}`;\n}\n\nexport default function websocketConnect(createWebSocket: CreateWebSocket, opts: Options) {\n  const { host, username, password, port, protocol } = opts;\n  const url = new Url('');\n  url.set('pathname', '/ws');\n  url.set('host', host);\n  url.set('protocol', protocol);\n  url.set('port', `${port}`);\n\n  const auth = generateAuthSubProto(username, password);\n  return createWebSocket(url.href, auth);\n}\n","import { NormalizedPath, Path } from './types';\n\n/**\n * Normalizes a path by turning it into an Array of strings.\n * Removes empty parts of the path and ignores redundant whitespace or\n * slashes. Each path element is also capitalized.\n *\n * @param path Array or string path to normalize.\n * @return Array of path segments.\n */\nexport default function normalizePath(path: Path): NormalizedPath {\n  const split = Array.isArray(path) ? path : path.match(/(\\w+)/g);\n  return !split\n    ? []\n    : split.map((element) => {\n        if (/^\\d+$/.test(element)) {\n          return parseInt(element, 10);\n        }\n        return element.charAt(0).toUpperCase() + element.slice(1);\n      });\n}\n","export const UNKNOWN_ERROR = 0;\nexport const COMMAND_ERROR = 1;\nexport const ILLEGAL_VALUE = 2;\nexport const INVALID_PATH = 3;\nexport const PARAMETER_ERROR = 4;\nexport const INVALID_RESPONSE = 5;\nexport const INVALID_STATUS = 6;\nexport const METHOD_NOT_FOUND = -32601;\n\nexport class XAPIError extends Error {\n  public data?: any;\n\n  constructor(readonly code: number, reason: string, data?: any) {\n    super(reason);\n    Object.setPrototypeOf(this, XAPIError.prototype);\n    if (data !== undefined) {\n      this.data = data;\n    }\n\n    if (typeof reason !== 'string') {\n      throw new Error('Reason for XAPIError must be a string');\n    }\n\n    if (typeof code !== 'number') {\n      throw new Error('Error code for XAPIError must be a number');\n    }\n  }\n}\n\nexport class IllegalValueError extends XAPIError {\n  constructor(reason: string) {\n    super(ILLEGAL_VALUE, reason);\n    Object.setPrototypeOf(this, IllegalValueError.prototype);\n  }\n}\n\nexport class InvalidPathError extends XAPIError {\n  constructor(reason: string, xpath: string) {\n    super(INVALID_PATH, reason, { xpath });\n    Object.setPrototypeOf(this, InvalidPathError.prototype);\n  }\n}\n\nexport class ParameterError extends XAPIError {\n  constructor() {\n    super(PARAMETER_ERROR, 'Invalid or missing parameters');\n    Object.setPrototypeOf(this, ParameterError.prototype);\n  }\n}\n","import {\n  IllegalValueError,\n  INVALID_RESPONSE,\n  INVALID_STATUS,\n  InvalidPathError,\n  ParameterError,\n  UNKNOWN_ERROR,\n  XAPIError,\n} from './exc';\nimport { XapiRequest } from './types';\n\nconst scalars = ['number', 'string'];\nconst isScalar = (value: any) => scalars.indexOf(typeof value) >= 0;\n\nconst VERSION = '2.0';\n\n/*\n * Collapse \"Value\" into parent + skip lowercase props\n */\nexport function collapse(data: any): any {\n  if (Array.isArray(data)) {\n    return data.map(collapse);\n  }\n  if (isScalar(data)) {\n    return data;\n  }\n  if ({}.hasOwnProperty.call(data, 'Value') && isScalar(data.Value)) {\n    return data.Value;\n  }\n\n  const result: { [idx: string]: any } = {};\n\n  Object.keys(data).forEach((key) => {\n    result[key] = collapse(data[key]);\n  });\n\n  return result;\n}\n\nexport function createRequest(id: string | null, method: string, params: any) {\n  const request: XapiRequest = { jsonrpc: VERSION, method };\n\n  if (id) {\n    request.id = id;\n  }\n\n  if (params) {\n    request.params = {};\n\n    Object.keys(params).forEach((key) => {\n      const value = params[key];\n\n      if (\n        key !== 'body' &&\n        typeof value === 'string' &&\n        value.indexOf('\\n') !== -1\n      ) {\n        throw new Error('Parameters may not contain newline characters');\n      }\n\n      request.params[key] = params[key];\n    });\n  }\n\n  return request;\n}\n\nexport function createResponse(id: string, result: any) {\n  return { jsonrpc: VERSION, id, result };\n}\n\nexport function createErrorResponse(id: string, error: any) {\n  let payload: { [idx: string]: any };\n\n  if (error instanceof XAPIError) {\n    payload = {\n      code: error.code,\n      message: error.message,\n    };\n  } else {\n    payload = {\n      code: UNKNOWN_ERROR,\n      message: (error.message || error).toString(),\n    };\n  }\n\n  if ({}.hasOwnProperty.call(error, 'data')) {\n    payload.data = error.data;\n  }\n\n  return { jsonrpc: VERSION, id, error: payload };\n}\n\nexport function parseFeedbackResponse(response: any) {\n  return collapse(response);\n}\n\nfunction assertResponseSuccess(response: any): any  {\n  const keys = Object.keys(response).filter((k) => k !== 'ResultId');\n  if (keys.length > 1) {\n    throw new XAPIError(\n      INVALID_RESPONSE,\n      `Invalid command response: Wrong number of keys (${keys.length})`,\n    );\n  }\n\n  if ({}.hasOwnProperty.call(response, 'CommandResponse')) {\n    return assertResponseSuccess(response.CommandResponse);\n  }\n\n  const root = response[keys[0]];\n  if (!root || !{}.hasOwnProperty.call(root, 'status')) {\n    return root;\n  }\n\n  switch (root.status) {\n    case 'Error': {\n      const body = collapse(root);\n      const { Error, Reason, XPath } = body;\n      const reason = Error || Reason || keys[0];\n\n      if (XPath) {\n        throw new InvalidPathError(reason, XPath);\n      }\n\n      throw new XAPIError(UNKNOWN_ERROR, reason, body);\n    }\n    case 'ParameterError':\n      throw new ParameterError();\n    case 'OK':\n      return root;\n    default:\n      throw new XAPIError(\n        INVALID_STATUS,\n        `Invalid command status: ${root.status}`,\n      );\n  }\n}\n\nfunction assertValidCommandResponse(response: any) {\n  if (!{}.hasOwnProperty.call(response, 'CommandResponse')) {\n    throw new XAPIError(\n      INVALID_RESPONSE,\n      'Invalid command response: Missing \"CommandResponse\" attribute',\n    );\n  }\n\n  return assertResponseSuccess(response);\n}\n\nexport function createCommandResponse(response: any) {\n  const root = assertValidCommandResponse(response);\n  const collapsed = collapse(root);\n  return Object.keys(collapsed).length ? collapsed : null;\n}\n\nfunction digObj(path: (string | number)[], obj: any) {\n  const parts = path.slice();\n  let value = obj;\n\n  while (parts.length) {\n    const part = parts.shift()!;\n    if (Array.isArray(value)) {\n      value = value.find((v) => parseInt(v.id, 10) === part);\n    } else if (!{}.hasOwnProperty.call(value, part)) {\n      return undefined;\n    } else {\n      value = value[part];\n    }\n  }\n\n  return value;\n}\n\nexport function createDocumentResponse(request: any, response: any) {\n  const { Path, Type } = request.params;\n  const isSchema = Type === 'Schema';\n  const path = [...Path];\n  const document = path[0].toLowerCase();\n\n  // Shim document/query inconsistencies\n  if (isSchema && 'status'.startsWith(document)) {\n    path[0] = 'StatusSchema';\n  } else if ('configuration'.startsWith(document)) {\n    path[0] = 'Configuration';\n  }\n\n  return digObj(path, response);\n}\n\nexport function createGetResponse(request: any, response: any) {\n  if ({}.hasOwnProperty.call(response, 'CommandResponse')) {\n    assertResponseSuccess(response.CommandResponse);\n  } else {\n    assertResponseSuccess(response);\n  }\n\n  return digObj(request.params.Path, collapse(response));\n}\n\nexport function createSetResponse(request: any, response: any) {\n  if ({}.hasOwnProperty.call(response, 'CommandResponse')) {\n    assertResponseSuccess(response.CommandResponse);\n  } else {\n    assertResponseSuccess(response);\n  }\n\n  if (Object.keys(response).length > 1) {\n    const leaf = digObj(request.params.Path, response);\n    if (leaf.error === 'True') {\n      throw new IllegalValueError(leaf.Value);\n    }\n  }\n  return null;\n}\n","/*\n * DO NOT WRITE OR UPDATE THIS FILE!\n * This file was automatically generated at: 2021-11-03T22:58:11.545Z\n */\nconst VERSION = '5.1.1';\nexport default VERSION;\n","import XAPI from '.';\nimport { Registration } from './feedback';\nimport normalizePath from './normalizePath';\nimport { Listener, Path } from './types';\n\nexport type AnyConstructor<T = object> = new (...args: any[]) => T;\n\n/**\n * Common base class for XAPI section types (commands, configs, events, statuses).\n */\nexport class Component {\n  /**\n   * Prefix to add to all paths for the component.\n   */\n  public prefix = '';\n\n  constructor(public readonly xapi: XAPI) {}\n\n  /**\n   * Normalizes a path including the component prefix.\n   *\n   * @param path Path to normalize.\n   * @return Normalized path.\n   */\n  public normalizePath(path: Path) {\n    const normalized = normalizePath(path);\n    const { prefix } = this;\n    return !prefix\n      ? normalized\n      : ([prefix] as (string | number)[]).concat(normalized);\n  }\n}\n\n/**\n * Mixin for XAPI sections that can trigger feedback.\n */\nexport interface Listenable<T> {\n    on(path: Path, listener: Listener<T>): Registration;\n    once(path: Path, listener: Listener<T>): Registration;\n    off(): void;\n}\n\nexport function Listenable<B extends AnyConstructor<Component>, T = any>(Base: B)\n  : B & AnyConstructor<Listenable<T>>\n{\n  return class Child extends Base implements Listenable<T> {\n    /**\n     * Register a new listener on the given path.\n     *\n     * @param path Path to XAPI entry.\n     * @param listener Callback handler called on changes.\n     * @typeparam T Event type.\n     * @return Handler to deregister the feedback registration.\n     */\n    public on(path: Path, listener: Listener<T>) {\n      return this.xapi.feedback.on(this.normalizePath(path) as any, listener);\n    }\n\n    /**\n     * Register a new listener on the given path, de-register\n     * after the first change happened.\n     *\n     * @param path Path to XAPI entry.\n     * @param listener Callback handler called on changes.\n     * @typeparam T Event type.\n     * @return Handler to deregister the feedback registration.\n     */\n    public once(path: Path, listener: Listener<T>) {\n      return this.xapi.feedback.once(this.normalizePath(path) as any, listener);\n    }\n\n    /**\n     * De-register the given listener on the given path.\n     *\n     * @deprecated Use deactivation handler from `.on()` and `.once()` instead.\n     */\n    public off() {\n      this.xapi.feedback.off();\n    }\n  };\n}\n\nexport interface Gettable<T> {\n    get(path: Path): Promise<T>;\n}\n\n/**\n * Mixin for XAPI sections that can hold a value that may be fetched.\n */\nexport function Gettable<B extends AnyConstructor<Component>, T = any>(Base: B)\n  : B & AnyConstructor<Gettable<T>>\n{\n  return class Child extends Base implements Gettable<T> {\n    /**\n     * Gets the value of the given path.\n     *\n     * ```typescript\n     * xapi.status\n     *   .get('Audio Volume')\n     *   .then((volume) => { console.log(volume); });\n     * ```\n     *\n     * ```typescript\n     * xapi.config\n     *   .get('Audio DefaultVolume')\n     *   .then((volume) => { console.log(volume); });\n     * ```\n     *\n     * @param path Path to configuration node.\n     * @typeparam T The return type of the get request.\n     * @return Resolved to the configuration value when ready.\n     */\n    public get(path: Path): Promise<T> {\n      return this.xapi.execute('xGet', {\n        Path: this.normalizePath(path),\n      });\n    }\n  };\n}\n\nexport interface Settable<T> {\n  set(path: Path, value: T): Promise<unknown>;\n}\n\n/**\n * Mixin for XAPI sections that can hold a value that may be fetched.\n */\nexport function Settable<B extends AnyConstructor<Component>, T = number | string>(Base: B)\n  : B & AnyConstructor<Settable<T>>\n{\n  return class Child extends Base implements Settable<T> {\n    /**\n     * Sets the path to the given value.\n     *\n     * ```typescript\n     * xapi\n     *   .config.set('SystemUnit Name', 'My System');\n     * ```\n     *\n     * @param path Path to status node.\n     * @param value Configuration value.\n     * @return Resolved to the status value when ready.\n     */\n    public set(path: Path, value: T) {\n      return this.xapi.execute('xSet', {\n        Path: this.normalizePath(path),\n        Value: value,\n      });\n    }\n  };\n}\n","import { Registration } from './feedback';\nimport { Component, Gettable, Listenable, Settable } from './mixins';\nimport { Listener, Path } from './types';\n\n/**\n * Interface to XAPI configurations.\n */\nexport class Config extends Listenable(Settable(Gettable(Component))) {\n  public prefix = 'Configuration';\n\n  // fake mixins\n  public normalizePath!: (path: Path) => (string | number)[];\n\n  public on!: <T = any>(path: Path, listener: Listener<T>) => Registration;\n  public once!: <T = any>(path: Path, listener: Listener<T>) => Registration;\n  public off!: () => void;\n\n  public get!: <T = any>(path: Path) => Promise<T>;\n  public set!: (path: Path, value: number | string) => Promise<any>;\n}\n\n/**\n * Interface to XAPI events.\n */\nexport class Event extends Listenable(Component) {\n  public prefix = 'Event';\n\n  // fake mixins\n  public normalizePath!: (path: Path) => (string | number)[];\n\n  public on!: <T = any>(path: Path, listener: Listener<T>) => Registration;\n  public once!: <T = any>(path: Path, listener: Listener<T>) => Registration;\n  public off!: () => void;\n}\n\n/**\n * Interface to XAPI statuses.\n */\nexport class Status extends Listenable(Gettable(Component)) {\n  public prefix = 'Status';\n\n  // fake mixins\n  public normalizePath!: (path: Path) => (string | number)[];\n\n  public on!: <T = any>(path: Path, listener: Listener<T>) => Registration;\n  public once!: <T = any>(path: Path, listener: Listener<T>) => Registration;\n  public off!: () => void;\n\n  public get!: <T = any>(path: Path) => Promise<T>;\n}\n","import { EventEmitter } from 'events';\n\nimport log from '../log';\n\nimport XAPI from '.';\nimport normalizePath from './normalizePath';\nimport { Handler, Listener, Path } from './types';\n\n/**\n * A function used to inspect and emit feedback data.\n *\n * The interceptor is free to change feedback payloads or discard them\n * entirely.\n */\nexport type FeedbackInterceptor =\n  /**\n   * @param payload The feedback payload.\n   * @param emit Function to dispatch a payload.\n   */\n  (payload: any, emit: (payload: any) => void) => void;\n\n/**\n * Type representing a feedback id.\n */\nexport interface FeedbackId {\n  Id: number;\n}\n\n/**\n * Type for a feedback registration request.\n */\nexport interface Registration {\n  /**\n   * De-register the feedback registration.\n   */\n  (): void;\n\n  /**\n   * Promise resolved with a feedback id on successful registration.\n   */\n  registration: Promise<FeedbackId>;\n}\n\n/**\n * Group feedback deregister handlers for bookkeeping.\n */\nexport class FeedbackGroup {\n  private handlers: Handler[];\n\n  constructor(handlers: Handler[]) {\n    this.handlers = handlers;\n  }\n\n  /**\n   * Add a deregister handler function to the feedback group.\n   *\n   * @param handler - Handler to add to the group.\n   * @return - this for chaining.\n   */\n  public add(handler: Handler) {\n    this.handlers.push(handler);\n    return this;\n  }\n\n  /**\n   * Remove a deregister handler function from the feedback group.\n   *\n   * @param handler - Handler to remove from the group.\n   * @return - this for chaining.\n   */\n  public remove(handler: Handler) {\n    this.handlers = this.handlers.filter((h) => h !== handler);\n    return this;\n  }\n\n  /**\n   * Call the deregister handler functions associated with this group.\n   *\n   * @return - this for chaining.\n   */\n  public off() {\n    this.handlers.forEach((handler) => {\n      handler();\n    });\n    this.handlers = [];\n    return this;\n  }\n}\n\nfunction defaultInterceptor<T>(payload: T, emit: (payload: T) => void) {\n  emit(payload);\n}\n\nfunction dispatch(\n  feedback: Feedback,\n  data: any,\n  root = data,\n  path: string[] = [],\n) {\n  if (Array.isArray(data)) {\n    data.forEach((child) => {\n      dispatch(feedback, child, root, path);\n      dispatch(feedback, child, root, path.concat(child.id));\n    });\n    return;\n  }\n\n  const emitPath = path.join('/').toLowerCase();\n  feedback.eventEmitter.emit(emitPath, data, root, root.Id);\n\n  if (typeof data === 'object') {\n    Object.keys(data).forEach((key) => {\n      dispatch(feedback, data[key], root, path.concat(key));\n    });\n  }\n}\n\n/**\n * Feedback handler for the XAPI.\n *\n * ### Register a feedback listener\n *\n * ```typescript\n * xapi.feedback.on('Status/Audio/Volume', data => {\n *   console.log(`Received feedback data: ${data}`);\n * });\n * ```\n *\n * ### Get the feedback root payload\n *\n * ```typescript\n * xapi.feedback.on('Status/Audio/Volume', (data, payload) => {\n *   console.log(`System volume changed to: ${data}`);\n *   JSON.stringify(payload) // => { Status: { Audio: { Volume: data } } }\n * });\n * ```\n *\n * ### Listen to array elements\n *\n * ```typescript\n * xapi.feedback.on('Status/Call[42]/Status', callStatus => {\n *   console.log(`Call status for call number 42 is: ${callStatus}`);\n * });\n * ```\n *\n * ### Bundle feedback listeners for easy unsubscription\n *\n * ```typescript\n * const feedbackGroup = xapi.feedback.group([\n *   xapi.status.on('Audio/Volume', volumeListener),\n *   xapi.status.on('Call', callListener),\n * ]);\n *\n * // Disable feedback listening for all listeners of the group.\n * feedbackGroup.off();\n * ```\n *\n * ### Register listener with Array path\n *\n * ```typescript\n * const off = xapi.feedback.on('Status/Audio/Volume', listener);\n * off(); // De-register feedback\n * ```\n */\nexport default class Feedback {\n  /**\n   * @param xapi XAPI instance.\n   * @param interceptor Feedback interceptor.\n   */\n  public readonly eventEmitter = new EventEmitter();\n  constructor(readonly xapi: XAPI, readonly interceptor: FeedbackInterceptor = defaultInterceptor) {}\n\n  /**\n   * Registers a feedback listener with the backend service which is invoked\n   * when there is feedback matching the subscription query.\n   *\n   * @param path Path to subscribe to.\n   * @param listener Listener invoked on feedback.\n   * @return Feedback cancellation function.\n   */\n  public on(path: Path, listener: Listener): Registration {\n    log.info(`new feedback listener on: ${path}`);\n    const eventPath = normalizePath(path)\n      .join('/')\n      .toLowerCase();\n\n    const registration = this.xapi.execute<FeedbackId>('xFeedback/Subscribe', {\n      Query: normalizePath(path),\n    });\n\n    let wrapper: <T = any>(ev: T, root: any, id?: number) => void;\n\n    const idP = registration.then(({ Id }) => {\n      wrapper = (ev, root, id) => {\n        if (typeof id !== 'undefined' && id !== Id) {\n          return;\n        }\n        listener(ev, root);\n      };\n      this.eventEmitter.on(eventPath, wrapper);\n      return Id;\n    });\n\n    const off = () => {\n      if (!wrapper) {\n        return;\n      }\n\n      idP.then((Id) => {\n        this.xapi.execute('xFeedback/Unsubscribe', { Id });\n      });\n\n      this.eventEmitter.removeListener(eventPath, wrapper);\n    };\n\n    off.registration = registration;\n    return off;\n  }\n\n  /**\n   * Registers a feedback listener similar to {@link on}, but the subscription\n   * is removed after the first invocation of the listener.\n   *\n   * @param path Path to subscribe to.\n   * @param listener Listener invoked on feedback.\n   * @return Feedback cancellation function.\n   */\n  public once<T = any>(path: Path, listener: Listener): Registration {\n    let off: Registration;\n    const wrapped = (ev: T, root: any) => {\n      if (typeof off === 'function') {\n        off();\n      }\n      listener.call(this, ev, root);\n    };\n    wrapped.listener = listener;\n    off = this.on(path, wrapped);\n    return off;\n  }\n\n  /**\n   * Remove feedback registration.\n   *\n   * @deprecated use deactivation handler from `.on()` and `.once()` instead.\n   */\n  public off() {\n    throw new Error(\n      '.off() is deprecated. Use return value deactivate handler from .on() instead.',\n    );\n  }\n\n  /**\n   * Dispatches feedback data to the registered handlers.\n   *\n   * @param data JSON data structure of feedback data.\n   * @return Returns self for chaining.\n   */\n  public dispatch(data: any) {\n    this.interceptor(data, (d = data) => dispatch(this, d));\n    return this;\n  }\n\n  /**\n   * Creates a grouper object which tracks which tracks the feedback paths and\n   * listeners being added to it.\n   *\n   * ### Bundle feedback listeners for easy unsubscription\n   *\n   * ```typescript\n   * // Create a group\n   * const group = xapi.feedback.group([\n   *   xapi.status.on('Audio Volume', (volume) => {\n   *     // ...\n   *   }),\n   *   xapi.config.on('Audio DefaultVolume', (volume) => {\n   *     // ...\n   *   }),\n   * ]);\n   *\n   * const handler = xapi.status.on('Call', (call) => { ... });\n   *\n   * // Add handler to the group\n   * group.add(handler);\n   *\n   * // Remove handler from the group\n   * group.remove(handler);\n   *\n   * // Unregister from all feedback handlers\n   * group.off();\n   * ```\n   *\n   * @return Proxy object for xapi.feedback.\n   */\n  public group(handlers: Handler[]) {\n    return new FeedbackGroup(handlers);\n  }\n}\n","// Proxy types inspired by:\n// https://www.typescriptlang.org/docs/handbook/advanced-types.html\n\nconst ACTIONS = ['get', 'set', 'on', 'once'];\n\nexport default function createProxy(thisArg: any, root: any, path: string[] = []): any {\n  const handlers = {\n    apply(target: any, _: any, args: any[]) {\n      if (typeof root === 'function') {\n        return root.call(thisArg, path.join('/'), ...args);\n      }\n      throw new TypeError(`Object is not callable: ${root}`);\n    },\n\n    get(target: any, property: string) {\n      if (ACTIONS.includes(property)) {\n        if (typeof root[property] !== 'function') {\n          throw new TypeError(`Property is not callable: ${root}[${property}]`);\n        }\n        return (...args: any[]) => root[property](path.join('/'), ...args);\n      }\n\n      return createProxy(thisArg, root, path.concat(property));\n    },\n  };\n\n  return new Proxy(root, handlers);\n}\n","import { EventEmitter } from 'events';\n\nimport log from '../log';\nimport normalizePath from './normalizePath';\nimport * as rpc from './rpc';\n\nimport { Backend } from '../backend';\nimport version from '../version';\nimport { Config, Event, Status } from './components';\nimport Feedback from './feedback';\nimport createXapiProxy from './proxy';\nimport { Path, XapiError, XapiOptions, XapiResponse } from './types';\n\nexport interface Requests {\n  [idx: string]: {\n    resolve(result: any): void;\n    reject(result: XapiError): void;\n  };\n}\n\nexport declare interface XAPI {\n  on(event: 'error', listener: (error: Error) => void): this;\n  on(event: 'ready', listener: (xapi: XAPI) => void): this;\n  on(event: string, listener: () => void): this;\n}\n\n/**\n * User-facing API towards the XAPI. Requires a backend for communicating\n * with an XAPI instance. It should be possible to write backends for all kinds\n * of transports (TSH over SSH, Websockets, HTTP, plain sockets, etc.)\n *\n * ### Initialization\n *\n * ```typescript\n * const xapi = new XAPI(backend);\n * ```\n *\n * ### Invoke command\n *\n * ```typescript\n * xapi\n *   .command('Dial', { Number: 'johndoe@example.com' })\n *   .then(onSuccess, onFailure);\n *\n * // Alternate notation\n * xapi\n *   .Command.Dial({ Number: 'johndoe@example.com' })\n *   .then(onSuccess, onFailure);\n * ```\n *\n * ### Fetch a configuration\n *\n * ```typescript\n * xapi\n *   .config.get('Audio DefaultVolume')\n *   .then((volume) => console.log(`default volume is: ${volume}`));\n *\n * // Alternate notation\n * xapi.Audio.DefaultVolume\n *   .get()\n *   .then((volume) => console.log(`default volume is: ${volume}`));\n * ```\n *\n * ### Set a configuration\n *\n * ```typescript\n * xapi.config.set('Audio DefaultVolume', 100);\n *\n * // Alternate notation\n * xapi.Audio.DefaultVolume.set(100);\n * ```\n *\n * ### Fetch a status\n *\n * ```typescript\n * xapi\n *   .status.get('Audio Volume')\n *   .then((volume) => { console.log(`volume is: ${volume}`); });\n *\n * // Alternate notation\n * xapi.Status.Audio.Volume\n *   .get()\n *   .then((volume) => { console.log(`volume is: ${volume}`); });\n * ```\n *\n * ### Listen to an event\n *\n * ```typescript\n * xapi.event.on('Message Send Text', (text) => {\n *   console.log(`Received message text: ${text}`);\n * });\n *\n * // Alternate notation\n * xapi.Event.Message.Send.Text.on((text) => {\n *   console.log(`Received message text: ${text}`);\n * });\n * ```\n */\nexport class XAPI extends EventEmitter {\n  public version: string = version;\n\n  /**\n   * Interface to XAPI feedback registration.\n   */\n  public feedback: Feedback;\n\n  /**\n   * Interface to XAPI configurations.\n   */\n  public config = new Config(this);\n\n  /**\n   * Interface to XAPI events.\n   */\n  public event = new Event(this);\n\n  /**\n   * Interface to XAPI statuses.\n   */\n  public status = new Status(this);\n\n  /**\n   * Proxy for XAPI Status.\n   */\n  public Command: any;\n\n  /**\n   * Proxy for XAPI Status.\n   */\n\n  public Config: any;\n  /**\n   * Proxy for XAPI Status.\n   */\n\n  public Status: any;\n\n  /**\n   * Proxy for XAPI Status.\n   */\n  public Event: any;\n\n  /**\n   * @param backend Backend connected to an XAPI instance.\n   * @param options XAPI object options.\n   */\n\n  private requestId = 1;\n  private requests: Requests = {};\n\n  constructor(\n    private readonly backend: Backend,\n    options: XapiOptions = {}) {\n    super();\n\n    this.feedback = new Feedback(this, options.feedbackInterceptor);\n    this.Command = createXapiProxy(this, this.command);\n    this.Config = createXapiProxy(this, this.config);\n    this.Event = createXapiProxy(this, this.event);\n    this.Status = createXapiProxy(this, this.status);\n\n    // Restrict object mutation\n    if (!options.hasOwnProperty('seal') || options.seal) {\n      Object.defineProperties(this, {\n        Command: { writable: false },\n        Config: { writable: false },\n        Event: { writable: false },\n        Status: { writable: false },\n        config: { writable: false },\n        event: { writable: false },\n        feedback: { writable: false },\n        status: { writable: false },\n      });\n      Object.seal(this);\n    }\n\n    backend\n      .on('close', () => {\n        this.emit('close');\n      })\n      .on('error', (error) => {\n        this.emit('error', error);\n      })\n      .on('ready', () => {\n        this.emit('ready', this);\n      })\n      .on('data', this.handleResponse.bind(this));\n  }\n\n  /**\n   * Close the XAPI connection.\n   */\n  public close(): XAPI {\n    this.backend.close();\n    return this;\n  }\n\n  /**\n   * Executes the command specified by the given path.\n   *\n   * ```typescript\n   * // Space delimited\n   * xapi.command('Presentation Start');\n   *\n   * // Slash delimited\n   * xapi.command('Presentation/Start');\n   *\n   * // Array path\n   * xapi.command(['Presentation', 'Start']);\n   *\n   * // With parameters\n   * xapi.command('Presentation Start', { PresentationSource: 1 });\n   *\n   * // Multi-line\n   * xapi.command('UserInterface Extensions Set', { ConfigId: 'example' }, `\n   *  <Extensions>\n   *    <Version>1.1</Version>\n   *    <Panel item=\"1\" maxOccurrence=\"n\">\n   *      <Icon>Lightbulb</Icon>\n   *      <Type>Statusbar</Type>\n   *      <Page item=\"1\" maxOccurrence=\"n\">\n   *        <Name>Foo</Name>\n   *        <Row item=\"1\" maxOccurrence=\"n\">\n   *          <Name>Bar</Name>\n   *          <Widget item=\"1\" maxOccurrence=\"n\">\n   *            <WidgetId>widget_3</WidgetId>\n   *            <Type>ToggleButton</Type>\n   *          </Widget>\n   *        </Row>\n   *      </Page>\n   *    </Panel>\n   *  </Extensions>\n   * `);\n   * ```\n   *\n   * @param path Path to command node.\n   * @param params Object containing named command arguments.\n   * @param body Multi-line body for commands requiring it.\n   * @return Resolved with the command response when ready.\n   */\n  public command<T = any>(path: Path, params?: object | string, body?: string): Promise<T> {\n    const apiPath = normalizePath(path).join('/');\n    const method = `xCommand/${apiPath}`;\n\n    let executeParams;\n    if (typeof params === 'string' && typeof body === 'undefined') {\n      executeParams = { body: params };\n    } else if ((typeof params === 'object' || !params) && typeof body === 'string') {\n      executeParams = Object.assign({ body }, params);\n    } else {\n      executeParams = params;\n    }\n\n    return this.execute<T>(method, executeParams);\n  }\n\n  /**\n   * Interface to XAPI documents.\n   *\n   * @param path Path to xDocument.\n   * @return xDocument as specified by path.\n   */\n  public doc<T = any>(path: Path) {\n    return this.execute<T>('xDoc', {\n      Path: normalizePath(path),\n      Type: 'Schema',\n    });\n  }\n\n  /**\n   * Execute the given JSON-RPC request on the backend.\n   *\n   * ```typescript\n   * xapi.execute('xFeedback/Subscribe', {\n   *   Query: ['Status', 'Audio'],\n   * });\n   * ```\n   *\n   * @param method Name of RPC method to invoke.\n   * @param params Parameters to add to the request.\n   * @typeparam T Return type.\n   * @return Resolved with the command response.\n   */\n  public execute<T>(method: string, params: any): Promise<T> {\n    return new Promise((resolve, reject) => {\n      const id = this.nextRequestId();\n      const request = rpc.createRequest(id, method, params);\n      this.backend.execute(request);\n      this.requests[id] = { resolve, reject };\n    });\n  }\n\n  private handleResponse(response: XapiResponse) {\n    const { id, method } = response;\n    if (method === 'xFeedback/Event') {\n      log.debug('feedback:', response);\n      this.feedback.dispatch(response.params);\n    } else {\n      if ({}.hasOwnProperty.call(response, 'result')) {\n        log.debug('result:', response);\n        const { resolve } = this.requests[id];\n        resolve(response.result);\n      } else {\n        log.debug('error:', response);\n        const { reject } = this.requests[id];\n        reject(response.error);\n      }\n      delete this.requests[id];\n    }\n  }\n\n  private nextRequestId() {\n    const requestId = this.requestId;\n    this.requestId += 1;\n    return requestId.toString();\n  }\n}\n\nexport default XAPI;\n","import { Backend } from './backend';\nimport WSBackend from './backend/ws';\nimport connectOverload from './connect';\nimport websocketConnect from './transport/ws';\nimport { Options } from './types';\nimport XAPI from './xapi';\n\nexport { default as XAPI } from './xapi';\n\nfunction initBackend(opts: Options) {\n  const { protocol } = opts;\n  switch (protocol) {\n    case '':\n    case 'ws:':\n    case 'wss:': {\n      const createWebSocket = (url: string, auth: string) => {\n        return new WebSocket(url, auth);\n      };\n      const transport = websocketConnect(createWebSocket, opts);\n      return new WSBackend(transport);\n    }\n    default:\n      throw new Error(`Invalid protocol: ${protocol}`);\n  }\n}\n\nexport function connectGen<T extends XAPI>(xapi: new (backend: Backend) => T) {\n  return connectOverload<T>(initBackend, { protocol: 'wss:' })(xapi);\n}\n\n/**\n * Connect to an XAPI endpoint.\n *\n * ```typescript\n * const xapi = connect('ssh://host.example.com:22');\n * ```\n *\n * @param url Connection specification.\n * @param options Connect options.\n * @return XAPI interface connected to the given URI.\n */\nexport const connect = connectGen(XAPI);\n"]}