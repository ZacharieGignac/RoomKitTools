"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var fs_1 = __importDefault(require("fs"));
var _1 = require("./");
var utils_1 = require("./utils");
function generate(schemas) {
    var fullSchema = schemas.reduce(function (schema, json) {
        return (0, utils_1.merge)(schema, (0, utils_1.filter)(json, ['public-api']));
    }, {});
    return (0, _1.parse)(fullSchema).serialize();
}
exports.default = generate;
if (module === require.main) {
    if (process.argv.length < 3) {
        throw new Error('usage: <schema.json> ...[schema.json]');
    }
    var json = process.argv.slice(2)
        .map(function (filename) {
        var data = fs_1.default.readFileSync(filename, 'utf8');
        return JSON.parse(data);
    });
    console.log(generate(json));
}
